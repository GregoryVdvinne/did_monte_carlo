100000*treated
) %>%
ungroup()
# #View revenue by treatment level, country and year
# inspection <- myData %>%
#   group_by(year, canada, treated) %>%
#   summarise(revenue = mean(revenue))
output <- my_event_study(myData)
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
# #CS att gt
# attgt <- att_gt(
#       yname = "revenue",
#       tname = "year",
#       idname = "id",
#       gname = "g",
#       data = myData
# )
#
# ggdid(attgt)
#
#Estimate CS w/ conditioning on country
event_study(
yname = "revenue",
tname = "year",
idname = "id",
gname = "g",
estimator = "did",
xformla = ~ usa,
data = myData
)
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
View(output)
#Estimate CS w/ conditioning on country
output <- event_study(
yname = "revenue",
tname = "year",
idname = "id",
gname = "g",
estimator = "did",
xformla = ~ usa,
data = myData
)
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
mutate(policy_year = sample(c(2019,2020,2021,2022,2023),1)) %>%
rowwise() %>%
mutate(policy = case_when(g<=year & g!=0 ~ 1,
TRUE ~ 0),
revenue = revenue + policy*-100000
)
#Add our policy variable and calculate our new revenue
myData <-  myData %>%
group_by(id) %>%
mutate(policy_year = sample(c(2019,2020,2021,2022,2023),1)) %>%
rowwise() %>%
mutate(policy = case_when(g<=year & g!=0 ~ 1,
TRUE ~ 0),
revenue = revenue + policy*-100000
)
#Add our policy variable and calculate our new revenue
myData <-  myData %>%
group_by(id) %>%
mutate(policy_year = case_when(
usa == 1 ~ sample(c(2019,2020,2021,2022,2023, rep(0,15)),1),
usa == 0 ~ sample(c(2019,2020,2021,2022,2023, rep(0,5)),1)
)
)%>%
rowwise() %>%
mutate(policy = case_when(policy_year<=year ~ 1,
TRUE ~ 0),
revenue = revenue + policy*-100000
)
output <- my_event_study(myData)
plot_event_study(output)
#Add our policy variable and calculate our new revenue
myData <-  myData %>%
group_by(id) %>%
mutate(policy_year = case_when(
usa == 1 ~ sample(c(2019,2020,2021,2022,2023, rep(0,15)),1),
usa == 0 ~ sample(c(2019,2020,2021,2022,2023, rep(0,5)),1)
)
)%>%
rowwise() %>%
mutate(policy = case_when(policy_year<=year ~ 1,
TRUE ~ 0),
revenue = rnorm(1, 1000000, 100000)
+ policy * -100000
+ treated * 100000
)
output <- my_event_study(myData)
plot_event_study(output)
#Add our policy variable and calculate our new revenue
myData <-  myData %>%
group_by(id) %>%
mutate(policy_year = case_when(
usa == 1 ~ sample(c(2019,2020,2021,2022,2023, rep(0,15)),1),
usa == 0 ~ sample(c(2019,2020,2021,2022,2023, rep(0,5)),1)
)
)%>%
rowwise() %>%
mutate(policy = case_when(policy_year<=year ~ 1,
TRUE ~ 0),
revenue = rnorm(1, 1000000, 100000)
+ policy * -200000
+ treated * 100000
)
output <- my_event_study(myData)
plot_event_study(output)
#Add our policy variable and calculate our new revenue
myData <-  myData %>%
group_by(id) %>%
mutate(policy_year = case_when(
usa == 1 ~ sample(c(2019,2020,2021,2022,2023, rep(0,15)),1),
usa == 0 ~ sample(c(2019,2020,2021,2022,2023, rep(0,5)),1)
)
)%>%
rowwise() %>%
mutate(policy = case_when(policy_year<=year ~ 1,
TRUE ~ 0),
revenue = rnorm(1, 1000000, 100000)
+ policy * -200000
+ treated * 100000
)
output <- my_event_study(myData)
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
#Estimate CS w/ conditioning on country
output <- event_study(
yname = "revenue",
tname = "year",
idname = "id",
gname = "g",
estimator = "did",
xformla = ~ usa,
data = myData
)
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
#Estimate Gardner w/ conditioning on policy
output <- event_study(
yname = "revenue",
tname = "year",
idname = "id",
gname = "g",
estimator = "did",
xformla = ~ policy,
data = myData
)
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
#Estimate Gardner w/ conditioning on policy
output <- event_study(
yname = "revenue",
tname = "year",
idname = "id",
gname = "g",
estimator = "did2s",
xformla = ~ policy,
data = myData
)
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
#Estimate Gardner w/ conditioning on policy
output <- event_study(
yname = "revenue",
tname = "year",
idname = "id",
gname = "g",
estimator = "TWFE",
xformla = ~ policy,
data = myData
)
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
#Add our policy variable and calculate our new revenue
myData <-  myData %>%
group_by(id) %>%
mutate(policy_year = case_when(
usa == 1 ~ sample(c(2019,2020,2021,2022,2023, rep(0,15)),1),
usa == 0 ~ sample(c(2019,2020,2021,2022,2023, rep(0,5)),1)
)
)%>%
rowwise() %>%
mutate(policy = case_when(policy_year<=year ~ 1,
TRUE ~ 0),
revenue = rnorm(1, 1000000, 100000)
+ policy * -2000000
+ treated * 100000
)
output <- my_event_study(myData)
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
#Estimate CS w/ conditioning on country
output <- event_study(
yname = "revenue",
tname = "year",
idname = "id",
gname = "g",
estimator = "did",
xformla = ~ usa,
data = myData
)
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
#Estimate Gardner w/ conditioning on policy
output <- event_study(
yname = "revenue",
tname = "year",
idname = "id",
gname = "g",
estimator = "TWFE",
xformla = ~ policy,
data = myData
)
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
#Add our policy variable and calculate our new revenue
myData <-  myData %>%
group_by(id) %>%
mutate(policy_year = case_when(
usa == 1 ~ sample(c(2019,2020,2021,2022,2023, rep(0,15)),1),
usa == 0 ~ sample(c(2019,2020,2021,2022,2023, rep(0,5)),1)
)
)%>%
rowwise() %>%
mutate(policy = case_when(policy_year<=year ~ 1,
TRUE ~ 0),
revenue = rnorm(1, 1000000, 100000)
+ policy * -2000000
+ treated * 100000
)
output <- my_event_study(myData)
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
#Estimate CS w/ conditioning on country
output <- event_study(
yname = "revenue",
tname = "year",
idname = "id",
gname = "g",
estimator = "did",
xformla = ~ usa,
data = myData
)
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
#Estimate Gardner w/ conditioning on policy
output <- event_study(
yname = "revenue",
tname = "year",
idname = "id",
gname = "g",
estimator = "did2s",
xformla = ~ policy,
data = myData
)
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
#Add our policy variable and calculate our new revenue
myData <-  myData %>%
group_by(id) %>%
mutate(policy_year = case_when(
usa == 1 ~ sample(c(2019,2020,2021,2022,2023, rep(0,15)),1),
usa == 0 ~ sample(c(2019,2020,2021,2022,2023, rep(0,5)),1)
)
)%>%
rowwise() %>%
mutate(policy = case_when(policy_year<=year ~ 1,
TRUE ~ 0),
revenue = rnorm(1, 1000000, 100000)
+ policy * -2000000
+ treated * 100000
)
output <- my_event_study(myData)
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
#Estimate CS w/ conditioning on country
output <- event_study(
yname = "revenue",
tname = "year",
idname = "id",
gname = "g",
estimator = "did",
xformla = ~ usa,
data = myData
)
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
#Estimate Gardner w/ conditioning on policy
output <- event_study(
yname = "revenue",
tname = "year",
idname = "id",
gname = "g",
estimator = "did2s",
xformla = ~ policy,
data = myData
)
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
#Estimate CS w/ conditioning on country
output <- event_study(
yname = "revenue",
tname = "year",
idname = "id",
gname = "g",
estimator = "TWFE",
xformla = ~ usa,
data = myData
)
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
#Add our policy variable and calculate our new revenue
myData <-  myData %>%
group_by(id) %>%
mutate(policy_year = case_when(
usa == 1 ~ sample(c(2019,2020,2021,2022,2023, rep(0,15)),1),
usa == 0 ~ sample(c(2019,2020,2021,2022,2023, rep(0,5)),1)
)
)%>%
rowwise() %>%
mutate(policy = case_when(policy_year<=year ~ 1,
TRUE ~ 0),
revenue = rnorm(1, 1000000, 100000)
+ policy * -2000000
+ treated * 100000
)
output <- my_event_study(myData)
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
#Estimate CS w/ conditioning on country
output <- event_study(
yname = "revenue",
tname = "year",
idname = "id",
gname = "g",
estimator = "did",
xformla = ~ policy,
data = myData
)
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
#Estimate Gardner w/ conditioning on policy
output <- event_study(
yname = "revenue",
tname = "year",
idname = "id",
gname = "g",
estimator = "did2s",
xformla = ~ policy,
data = myData
)
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
#Estimate CS w/ conditioning on country
output <- event_study(
yname = "revenue",
tname = "year",
idname = "id",
gname = "g",
estimator = "TWFE",
xformla = ~ policy,
data = myData
)
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
#Add our policy variable and calculate our new revenue
myData <-  myData %>%
group_by(id) %>%
mutate(policy_year = case_when(
usa == 1 ~ sample(c(2019,2020,2021,2022,2023, rep(0,15)),1),
usa == 0 ~ sample(c(2019,2020,2021,2022,2023, rep(0,5)),1)
)
)%>%
rowwise() %>%
mutate(policy = case_when(policy_year<=year ~ 1,
TRUE ~ 0),
revenue = rnorm(1, 1000000, 100000)
+ policy * -200000
+ treated * 100000
)
output <- my_event_study(myData)
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
#Estimate CS w/ conditioning on policy
output <- event_study(
yname = "revenue",
tname = "year",
idname = "id",
gname = "g",
estimator = "did",
xformla = ~ policy,
data = myData
)
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
#Estimate Gardner w/ conditioning on policy
output <- event_study(
yname = "revenue",
tname = "year",
idname = "id",
gname = "g",
estimator = "did2s",
xformla = ~ policy,
data = myData
)
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
#Estimate TWFE w/ conditioning on policy
output <- event_study(
yname = "revenue",
tname = "year",
idname = "id",
gname = "g",
estimator = "TWFE",
xformla = ~ policy,
data = myData
)
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
View(myData)
#Add our policy variable and calculate our new revenue
myData <-  myData %>%
group_by(id) %>%
mutate(policy_year = case_when(
usa == 1 ~ sample(c(2019,2020,2021,2022,2023, rep(0,15)),1),
usa == 0 ~ sample(c(2019,2020,2021,2022,2023, rep(0,5)),1)
)
)%>%
rowwise() %>%
mutate(policy = case_when(policy_year<=year & policy_year !=0 ~ 1,
TRUE ~ 0),
revenue = rnorm(1, 1000000, 100000)
+ policy * -200000
+ treated * 100000
)
output <- my_event_study(myData)
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
# #Estimate CS w/ conditioning on country
# output <- event_study(
#       yname = "revenue",
#       tname = "year",
#       idname = "id",
#       gname = "g",
#       estimator = "did",
#       xformla = ~ usa,
#       data = myData
#       )
#Add column for true effect to DF of estimates
output <- left_join(output, true_effect, by = "term")
plot_event_study(output) +
geom_line(aes(x = term, y=true_effect), color = "red")
View(output)
View(myData)
View(output)
